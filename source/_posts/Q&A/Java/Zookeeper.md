---
title: Zookeeper
date: 2022-05-10 18:07:28
tags: Q&A
categories:
- [Q&A, Q&A-java]
---

## zookeeper 是什么？
一个分布式的、开源的分布式应用程序协调服务，是google chubby的开源实现，是hadoop和hbase的重要组件。它是一个为分布式应用提供一致性服务的软件，提供的功能包括：配置维护、域名服务、分布式同步、组服务等

## zookeeper都有哪些功能？
|功能点|功能介绍|
|---|---|
|集群管理|监控集群节点状态、运行请求等|
|主节点选举|即主节点挂掉之后从备用节点开始新一轮主节点的选举，使用zookeeper可以协助完成该过程|
|分布式锁|zookeeper提供两种锁：<br/>1、独占锁：只有一个线程使用资源<br/>2、共享锁：多个线程可读，一个线程可写|
|命名服务|客户端根据命名服务中制定的名字可以更方便的获取资源、服务地址、提供者等信息|

## zookeeper 有几种部署模式？
|部署模式|简介|
|---|---|
|单机部署|一台机器上机器上运行|
|集群部署|多台机器上运行|
|伪集群部署|一台机器上部署多个实例运行|

## zookeeper 怎么保证主从节点的状态同步？
### 通过**原子广播机制**实现实现节点间的状态同步，该机制依赖zab协议。
### zab协议两种模式介绍
|模式|简介|
|---|---|
|恢复（选主）模式|当主节点崩溃时，会进入该模式，首先重新选出主节点，然后其他节点会与新主节点完成同步|
|广播（同步）模式|即主节点发生变化时，向其他节点广播以完成同步|

## 集群中为什么要有主节点？
在分布式环境中，有些业务只需要一个节点完成处理，其他节点共享该处理结果即可，这样可以减少运算资源消耗，提升效率，所以就需要设置一个主节点实现该需求

## 集群中有 3 台服务器，其中一个节点宕机，这个时候 zookeeper 还可以使用吗？
可以继续使用，奇数个节点的集群只要没超过一半节点宕机就可以继续正常对外提供服务

## 说一下 zookeeper 的通知机制？
客户端会对znode建立一个watcher事件，当znode发生变化时，这些客户端会受到zookeeper的通知，然后就可以根据该通知进行相关业务处理
