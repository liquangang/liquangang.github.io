---
title: MySql
date: 2022-05-11 12:06:44
tags: Q&A
categories:
- [Q&A, Q&A-java]
---

## 数据库的三范式是什么？
|范式|简介|
|---|---|
|第一范式|强调表的每一列的原子性，即数据库表的每一列都是不可分割的原子数据项|
|第二范式|要求实体的属性完全依赖主关键字，不能存在只依赖主关键字一部分的属性|
|第三范式|任何非主属性不依赖其他非主属性|

## 一张自增表里面总共有 7 条数据，删除了最后 2 条数据，重启 mysql 数据库，又插入了一条数据，此时 id 是几？
1、如果设置表类型为MyISAM，id就是8，该类型下，mysql会在数据文件中持久化主键最大id，所以重启之后最大主键依然是7
2、如果设置表类型为InnoDB，id就是6，该类型下，mysql只在内存中保存主键最大id，重启会丢失，重启之后从表中重新加载到内存当中的最大主键是5
3、如果删除的是中间的数据，那么id是相同的，都是8

## 如何获取当前数据库版本？
select version()

## 说一下 ACID 是什么？
#### 即数据库写表过程中，为保证事务正确可靠，确立的四个特性
|特性|简介|
|---|---|
|Atomicity（原子性）|一个事务的所有操作要么全部完成，要么全部不完成，即恢复到事务执行前的样子，即事务不可分割、不可约简|
|Consistency（一致性）|事务执行过程中，数据库完整性不会被破坏，即写入的数据必须符合预设约束、触发器、级联回滚等|
|Isolation（事务隔离）|数据库允许多个事务同时进行读写，隔离性是为了保证并发执行时数据一致。事务隔离分为不同级别：读未提交（Read uncommitted）、读提交（Read committed）、可重复读（Repeatable read）、串行化（Serializable）|
|Durability（持久性）|事务执行成功后对数据的修改是永远生效的，即便系统异常也不会丢失|

## char 和 varchar 的区别是什么？
||char(n)：固定长度字符类型，占用部分或者全部空间，剩余空间使用空字节占用，即总长度固定|varchar(n)：可变长度字符类型，即数据会占用与自身长度相同的空间，再加上一个表示该数据长度的字节，这两部分即整体的长度|
|---|---|---|
|效率|高|低|
|占用空间|高|低|
|使用场景|存储固定长度|存储可变长度的|

## float 和 double 的区别是什么？
||float|double|
|---|---|---|
|存储十进制数长度|8位|16位|
|内存占用|4字节|8字节|

## mysql 的内连接、左连接、右连接有什么区别？
||内连接|左连接|右连接|
|---|---|---|---|
|关键字|inner join|left join|right join|
|作用|把匹配的关联数据全部查出来|左边的表全部查出来，右边的表查出来符合条件的数据|右边的表全部查出来，左边的表查出来符合条件的数据|

## mysql 索引是怎么实现的？
### 索引简介
满足某种特定查找算法的数据结构，这些数据结构会以某种方式指向数据，以实现高效查询

### 实现原理
目前主流的数据库引擎都采用B+树实现，性能与二分法类似

## 怎么验证 mysql 的索引是否满足需求？
### 原理
使用explain查看sql是如何执行查询语句的，从而分析索引是否满足需求

### explain语句示例
explain select * from table where type=1;

## 说一下数据库的事务隔离？
### 事务隔离意义：解决并发过程中出现个四个异常
|异常类型|简介|
|---|---|
|脏写|一个事务写完数据后，另一个事务回滚了该数据|
|脏读|一个事务读完数据后，另一个事务回滚了该数据|
|不可重复读|事务多次读取同一条数据，数据结果不一致|
|幻读|事务新增或者删除操作执行完成后，发现有未正常处理数据|

### 配置位置
在MySQL.ini中进行配置，具体配置项为transcation-isolation

### 配置可选值
|可选配置值|简介|特点|
|---|---|---|
|READ-UNCOMMITTED|未提交读，最低隔离级别，事务未提交前，就可被其他事务读取，不允许两个未提交的事务同时修改一条数据|解决脏写，会出现幻读、脏读、不可重复读|
|READ-COMMITTED|提交读，一个事务提交后才能被其他事务读取到|解决脏写、脏读，会造成幻读、不可重复读|
|REPEATABLE-READ|可重复读，默认级别，保证多次读取同一数据时，其值都和事务开始时内容一致，禁止读取到别的事务未提交的数据，只要多次数据相同即可|会造成幻读|
|SERIALIZABLE|序列化，代价最高同时时最可靠的隔离级别，就是串行，无并发问题|防止脏读、幻读、不可重复读|

## 说一下 mysql 常用的引擎？
|引擎|简介|
|---|---|
|InnoDB引擎|1、提供了对数据库ACID事务的支持，并且提供了行级锁、外键的约束，设计目标就是处理大数据量的数据库系统<br/>2、MySQL运行时，InnoDB会在内存中建立缓存池，用来缓存数据和索引<br/>3、该引擎不支持全文搜索，启动较慢，不会保存表行数，执行select count时，需要扫描全表<br/>4、提供行级锁，锁粒度小，写操作不会锁定全表，适合并发较高的场景|
|MyIASM引擎|1、MySQL默认引擎，不提供事务支持，不支持行级锁和外键，写操作时需要锁整个表，效率较低<br/>2、保存了表行数，执行select count时不需要扫描全表<br/>3、如果读操作多余写操作，并且不需要事务支持，使用MyIASM更合适|

## 说一下 mysql 的行锁和表锁？
### MyIASM只支持表锁，InnoDB支持行锁和表锁
### 行锁、表锁简介
||行锁|表锁|
|---|---|---|
|开销|大|小|
|加锁速度|慢|快|
|会不会出现死锁|会|不会|
|粒度|小|大|
|锁冲突概率|小|大|
|并发量|高|低|

## 说一下乐观锁和悲观锁？
|锁类型|介绍|
|---|---|
|乐观锁|乐观的认为读过程中数据不会同时被修改，所以读不上锁，写上锁，锁需要自己实现|
|悲观锁|悲观的认为数据可能同时被修改，所以读写均上锁|

## mysql 问题排查都有哪些手段？
1、使用show processlist查看当前所有连接信息
2、使用explain语句查询sql语句执行情况
3、开启慢查询日志，查看慢查询sql

## 如何做 mysql 的性能优化？
1、为搜索字段创建索引
2、优化查询语句，比如不要使用select *，直接列出所有字段
3、垂直分割分表
4、选择正确的存储引擎，MyIASM或者InnoDB
5、选取合适的字段属性
